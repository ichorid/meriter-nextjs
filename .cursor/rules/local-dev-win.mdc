---
description: Local development commands for Windows. Include when need to run, build, or test the project.
globs: []
alwaysApply: false
---

# Local Development Commands (Windows PowerShell)

## Start Servers

Use two terminals for full local stack: API and Web.

**Terminal 1 — API:**
```powershell
cd api
$env:DOMAIN="localhost"
pnpm dev
# Runs on http://localhost:8002
```

**Terminal 2 — Web:**
```powershell
cd web
$env:DOMAIN="localhost"
$env:NEXT_PUBLIC_FAKE_DATA_MODE="true"
$env:NEXT_PUBLIC_TEST_AUTH_MODE="true"
pnpm dev
# Runs on http://localhost:8001
```

## Key Commands

Run from **repository root** (where the root `package.json` is).

```powershell
# Install dependencies
pnpm install

# Lint: run BEFORE EVERY COMMIT (see @pnpm.mdc)
pnpm lint
pnpm lint:fix

# Build
pnpm build

# Run tests
pnpm test
```

## Ports
- **8001** — Next.js (frontend)
- **8002** — NestJS (backend API)
- **8080** — Caddy (optional reverse proxy)

## Common Issues

**"Failed to fetch" tRPC errors:**
→ If `NEXT_PUBLIC_API_URL` is set in `web/.env`, ensure it points to a reachable API (e.g. `http://localhost:8002`). If unset, the frontend uses the same host as the page. Comment it out or remove it to fall back to same-origin.

**"DOMAIN environment variable is required":**
→ Add `DOMAIN=localhost` to both `api/.env` and `web/.env`

## Full Setup Guide
See `docs/LOCAL_DEVELOPMENT_SETUP.md` for detailed instructions.