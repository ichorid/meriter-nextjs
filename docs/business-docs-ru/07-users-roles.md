# 07. Пользователи и роли

> Данные профиля, роли и права пользователей.

---

## Данные пользователя

### Данные профиля (заполняются пользователем)

| Поле | Обязательность | Описание |
|------|----------------|----------|
| Имя | Да | Отображаемое имя |
| О себе | Да | Краткое описание |
| Аватар | Нет | Изображение профиля |
| Контактные данные | Нет | Способы связи |

### Системные данные

| Поле | Описание |
|------|----------|
| Роли в сообществах | Список ролей для каждого сообщества |
| Активность | Сводки по постам и голосам |
| Избранное | Посты, отмеченные как избранные |
| Мериты | Количество меритов в каждом сообществе |
| Квота | Текущий остаток квоты в сообществах с квотой |
| Архив постов | Закрытые посты пользователя |

---

## Роли

Роли **специфичны для каждого сообщества** — пользователь может иметь разные роли в разных сообществах.

### Участник сообщества
**Базовая роль.** Присваивается при вступлении в сообщество.

**Права:**
- Публиковать посты (если разрешено настройками)
- Комментировать посты
- Голосовать за посты
- Участвовать в опросах
- Участвовать в тапалке
- Создавать локальные сообщества

### Лид сообщества
**Администратор локального сообщества.** Создатель сообщества или назначенный им.

**Права (в дополнение к участнику):**
- Доступ к настройкам сообщества
- Управление участниками
- Модерация контента
- Начисление меритов участникам

**Ограничения:**
- Не может удалить сообщество (только заявка администрации)
- Не может изменить режим пересылки постов (всегда копия без меритов)

### Администратор глобального сообщества
**Назначается суперадмином.** Администрирует конкретное глобальное сообщество.

**Права:**
- Все права лида для своего глобального сообщества
- Настройка параметров глобального сообщества
- Управление категориями постов

### Суперадминистратор
**Полный доступ ко всей платформе.**

**Права:**
- Администратор всех глобальных сообществ
- Доступ к настройкам всех локальных сообществ
- Создание глобальных сообществ
- Назначение администраторов глобальных сообществ
- Прямое начисление меритов любому пользователю
- Настройка рейтов (множителей) для сообществ
- Удаление сообществ

---

## Правила участия в сообществах

### Вступление
- Пользователь автоматически становится участником **всех глобальных сообществ** при регистрации
- В локальные сообщества вступает добровольно

### Множественное участие
- Пользователь может состоять в **любом количестве** сообществ
- Пользователь может быть лидом **любого количества** сообществ

### Выход
- Из локального сообщества — можно выйти по желанию
- Из глобального сообщества — **нельзя** выйти

### Удаление сообщества
- Лид **не может** удалить сообщество самостоятельно
- Можно только оставить заявку администрации на удаление

---

## Регистрация

### Процесс регистрации

```
┌─────────────────────────────────────────────────────────┐
│ 1. Выбор способа авторизации                            │
│    (Яндекс / SMS / Звонок / E-mail)                     │
└───────────────────────────┬─────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────┐
│ 2. Заполнение профиля                                   │
│    - Имя (обязательно)                                  │
│    - О себе (обязательно)                               │
│    - Аватар (опционально)                               │
│    - Контакты (опционально)                             │
│    - Инвайт-код (опционально)                           │
└───────────────────────────┬─────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────┐
│ 3. Автоматические действия                              │
│    - Роль «Участник» во всех глобальных сообществах     │
│    - +100 приветственных меритов                        │
│    - Доп. роль по инвайт-коду (если был введён)         │
└─────────────────────────────────────────────────────────┘
```

### Стартовые мериты
При регистрации пользователь получает **100 глобальных меритов** на счёт.

---

## Инвайт-коды

> **Статус:** Временный костыль. Будет заменён на полноценную систему управления участниками.

### Текущая реализация
Инвайт-коды — основной инструмент выдачи ролей пользователям.

**Типы кодов:**

| Тип | Эффект |
|-----|--------|
| Вступление в сообщество | Роль участника в указанном сообществе |
| Создание сообщества | Генерирует новое сообщество, назначает пользователя лидом |
| Роль суперадмина | Даёт права суперадминистратора |

### Проблемы текущей реализации
- Вносят путаницу при пересылке
- Неудобны для управления командами

### Планируемая замена (v1.5+)
Кнопка «Добавить в команду» для лидов:
- Поиск пользователей по имени (как в GitHub)
- Прямое приглашение в сообщество
- Без необходимости генерировать и передавать коды

---

## Авторизация

### Реализованные методы
- Яндекс
- SMS
- Звонок
- E-mail

### Планируемые методы
- Мессенджеры (Telegram и др.)
- Google

### Будущее (когда появятся ценные ресурсы)
- Авторизация через Госуслуги
- Для вывода материальных ценностей
- Позволит идентифицировать личность

---

## Смена лида сообщества

> **Статус:** Не реализовано. Запланировано на P1.

### Планируемая механика
- Текущий лид может передать права другому участнику
- Или назначить дополнительного лида
- Суперадмин может назначить нового лида принудительно
